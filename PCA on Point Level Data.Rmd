---
title: "PCA on Point Level Data"
author: "Corey Pang"
date: "7/2/2017"
output: html_document
---

```{r}
install.packages("devtools", repos = "http://cran.us.r-project.org")
library(devtools)
install_github("vqv/ggbiplot", force=TRUE)
library(ggbiplot)
install.packages("FactoMineR", repos = "http://cran.us.r-project.org")
library(FactoMineR)
getwd()
dir <- file.path(getwd(),"Point level data")
out <- read.csv(file.path(dir, "MU-BU-Ghana.csv"))
newout <- na.omit(out)
```
 
### PCA on Water Variables 
```{r1}
pr.data <- prcomp( newout[,57:80], scale = TRUE, center = TRUE)
summary(pr.data) 
pr.water.var <- pr.data$sdev^2
pve.water <- pr.water.var/sum(pr.water.var)
percent.pve.water <- pr.water.var/sum(pr.water.var) * 100
barplot(percent.pve.water, xlab="PC",
            ylab="Percent Variance", 
            main = "Barplot of Percentage of Total Variation",
            names.arg=1:length(percent.pve.water), las=1, 
            ylim=c(0,max(percent.pve.water)), col="gray")
#Scree Plot
plot(pve.water, xlab = "Principal Component",
             ylab = "Proportion of Variance Explained",
             main = "Scree Plot for Water Variables",
             type = "b")
#Cumulative Scree Plot
plot(cumsum(pve.water), xlab = "Principal Component",
              ylab = "Cumulative Proportion of Variance Explained",
              main = "Cumulative Scree Plot for Water Variables",
              type = "b")
ggbiplot(pr.data, obs.scale = 1, var.scale = 1,
              ellipse = TRUE, 
              circle = TRUE)
pr.data <- PCA( newout[,57:80], scale.unit = TRUE, ncp = 6)
dimdesc(pr.data)
```

### PCA on LULC Variables without Wetness Index Variables

```{r2}
lulc.var <- newout[,29:56]
pr.lulc.data <- prcomp(x = lulc.var, scale = TRUE, center = TRUE)
summary(pr.lulc.data) 
pr.var <- pr.lulc.data$sdev^2
pve <- pr.var/sum(pr.var)
percent.pve <- pr.var/sum(pr.var) * 100
barplot(percent.pve, xlab="PC", 
            ylab="Percent Variance", 
            main = "Barplot of Percentage of Total Variation",
            names.arg=1:length(percent.pve), las=1, 
            ylim=c(0,max(percent.pve)), col="gray")
#Scree Plot
plot(pve, xlab = "Principal Component",
             ylab = "Proportion of Variance Explained",
             main = "Scree Plot for LULC Variables (Excluding Wet.Index Variables)",
             type = "b")
#Cumulative Scree Plot
plot(cumsum(pve), xlab = "Principal Component",
              ylab = "Cumulative Proportion of Variance Explained",
              main = "Cumulative Scree Plot for LULC Variables (Excluding Wet.Index Variables)",
              type = "b")
ggbiplot(pr.lulc.data, obs.scale = 1, var.scale = 1,
              ellipse = TRUE, 
              circle = TRUE)
```

### PCA on LULC Variables with Wetness Index Variables
```{r3}
lulc.wet.var <- cbind(newout[,19:26], newout[, 29:56])
pr.lulc.wet.data <- prcomp(x = lulc.wet.var, scale = TRUE, center = TRUE)
summary(pr.lulc.wet.data) 
pr.var <- pr.lulc.wet.data$sdev^2
pve <- pr.var/sum(pr.var)
percent.pve <- pr.var/sum(pr.var) * 100
barplot(percent.pve, xlab="PC",
            ylab= "Percent Variance", 
            main = "Barplot of Percentage of Total Variation",
            names.arg=1:length(percent.pve), las=1, 
            ylim=c(0,max(percent.pve)), col="gray")

plot(pve, xlab = "Principal Component",
             ylab = "Proportion of Variance Explained",
             main = "Scree Plot for LULC Variables (Including Wet.Index Variables)",
             type = "b")

plot(cumsum(pve), xlab = "Principal Component",
              ylab = "Cumulative Proportion of Variance Explained", 
              main = "Cumulative Scree Plot for LULC Variables (Including Wet.Index Variables)",
              type = "b")
ggbiplot(pr.lulc.wet.data, obs.scale = 1, var.scale = 1,
              ellipse = TRUE, 
              circle = TRUE)
```
